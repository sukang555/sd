<!DOCTYPE>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">

<head th:replace="/common/template :: header(~{::title},~{::link},~{::style})">
    <link rel="stylesheet" th:href="@{/lib/zTree_v3/css/zTreeStyle/zTreeStyle.css}" type="text/css">
</head>
<body class="timo-layout-page">
<div class="layui-card">
    <div class="layui-card-header timo-card-header">
        <span><i class="fa fa-bars"></i> 用户管理</span>
        <i class="layui-icon layui-icon-refresh refresh-btn"></i>
    </div>
    <div class="layui-card-body">
        <div class="layui-row timo-card-screen put-row">
            <div class="pull-left layui-form-pane timo-search-box">
                <div class="layui-inline">
                    <label class="layui-form-label">状态</label>
                    <div class="layui-input-block timo-search-status">
                        <select class="timo-search-select" name="status" mo:dict="SEARCH_STATUS"
                                mo-selected="${param.status}"></select>
                    </div>
                </div>

                <div class="layui-inline">
                    <label class="layui-form-label">用户名</label>
                    <div class="layui-input-block">
                        <input type="text" name="username" th:value="${param.username}" placeholder="请输入用户名"
                               autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">用户昵称</label>
                    <div class="layui-input-block">
                        <input type="text" name="nickname" th:value="${param.nickname}" placeholder="请输入用户昵称"
                               autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-inline">
                    <button class="layui-btn timo-search-btn">
                        <i class="fa fa-search"></i>
                    </button>
                </div>
            </div>
            <div class="pull-right screen-btn-group">

            </div>
        </div>
        <div class="timo-table-wrap">
            <table id="user-list-table" class="layui-hide"></table>
        </div>

    </div>
</div>

<script type="text/javascript" th:src="@{/js/plugins/jquery-2.2.4.min.js}"></script>
<script type="text/javascript" th:src="@{/lib/zTree_v3/js/jquery.ztree.core.min.js}"></script>
<script type="text/javascript" th:src="@{/js/timoTree.js}"></script>
<script th:replace="/common/template :: script"></script>
<script type="text/javascript">
    layui.use('table', function(){
        var table = layui.table;

        table.render({
            elem: '#user-list-table',
            request: {
                pageName: 'pageNum', //页码的参数名称，默认：page
                limitName: 'pageSize' //每页数据量的参数名，默认：limit
            },
            url:'/user-info/list',
            method: "POST" ,
            contentType : "application/json;charset=UTF-8",
            data :function(param){
                param.pageNum = 1;
                return JSON.stringify(param);
            },
            cellMinWidth: 80 ,//全局定义常规单元格的最小宽度，layui 2.2.1 新增
            cols: [
                [
                    {field:'userId', width:120, title: 'ID', sort: true},
                    {field:'userName', width:120, title: '用户名', sort: true},
                    {field:'userName', width:120, title: '用户昵称'},
                    {field:'city', width:260, title: '城市'},
                    {field:'sex', title: '性别' },
                    {field:'phone', title: '电话' },
                    {field:'email', title: '邮箱' },
                    {field:'createTime', title: '创建时间'}
                ]
            ],
            page: true,
            response: {
                statusCode: 200 //重新规定成功的状态码为 200，table 组件默认为 0
            },
            parseData: function(res) { //将原始数据解析成 table 组件所规定的数据
                return {
                    "code": res.code, //解析接口状态
                    "msg": res.errorMsg, //解析提示文本
                    "count": res.body.total, //解析数据长度
                    "data": res.body.list //解析数据列表
                };
            }
        });

        //监听行单击事件（双击事件为：rowDouble）
        table.on('row(user-list-table)', function(obj){
            //标注选中样式
            obj.tr.addClass('layui-table-click').siblings().removeClass('layui-table-click');
        });
    });

</script>
</body>
</html>